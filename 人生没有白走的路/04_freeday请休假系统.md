# freeday请休假系统

## 项目背景

19年12月入职新公司，开始和另两位开发协作完成部门请休假系统的研发，项目于1月份上线第一版，并在3月份完成主要功能的开发，进入迭代优化。12月份与集团的考勤系统进行切换，完成它的使命。

## 技术选型

前端：react，antd
后端：Django, Django restful framework
数据库：mysql

## 负责模块

### 报表导出

1. what
- 按照HR给定的假期折算规则进行数据的统计
- 年假余额和加班余额的统计

2. why
- 假期数据对于员工发放薪资具有重要意义，需要保证数据的准确性
- 员工剩余假期的查看，已方便员工调转到集团

3. how
- xlswriter库，非常方便的去写excel
- 在统计时，需要注意算法的时间复杂度，保证效率
- 对数据准确性要求高，补充测试用例帮助完成功能


### 假期逻辑

1. what
- 假期扣假业务，这是我工作以来接触的复杂业务里的TOP3了
- 假期种类繁多，每种假期的扣假规则不一样
- 年假和调休假有特定的过期时间，在处理上需要结合员工实际请假区间来判定
- 除了请假外还有销假逻辑，这里还涉及审核顺序的问题，万一销毁了前面的假期，为了员工的最大利益，需要调整后面每一条假期的实际扣除

2. why
- 这个功能非常核心，一旦每个分支出错，都会影响员工利益，遭到投诉。

3. how
- 一方面，所有的扣假销假逻辑，均有测试用例支持（内）
- 考虑高并发的场景，给假期数据表加锁
- 前端审核时加loading，后端处理时加锁
- 定期跑检测脚本，及时发现异常数据（外）

### 分布式锁

多台实例，需要给同时执行的任务加分布式锁。

## 心得总结

这是入职新公司后，参与的第一个项目。

那时候的我是一个什么样的状态呢，19年时因为一段奇缘，让我对编程以及职业精神的理解上升了新的高度。我知道了自己的方向，但我迫切需要一个场所，去把自己新磨炼出的能力加以运用，并且凸显自己的价值。

可以说在19年之前，我在开发一个系统的时候，常常丢三落四，关注细节而非整体，不懂得合理抽象，常常加班到很晚。

现在可以说，我对自己的计划性有了新的突破，我知道如何安排和规划任务，并且一步一步的进行落地。

我觉得，未来如果有同类型的项目，我会做的很不错。在参与freeday开发的时候，事实也确实证明了这样，毕竟自认为，自己在团队里的价值是逐步上升的，很快就成为了核心主力。

所以我应该更自信一点。

freeday是一个转折，是我开始改变心态，逐渐去释放自己的能量的一个开始，未来的很多项目，我在里面承担的角色也都是中流砥柱型的。

但是，这也是一个不好的开始，因为原定的职业发展路线，被冲散了，这是意料之外的事情。

我本来是想往运维系统研发的方向走，因为在实习期，我没有提出合理的诉求，在我实习期还没过的时候，原来的部门就因为组织架构调整划分到了别的组里，我与原来的发展方向也越来越远。

对此我非常的心痛，尝试沟通过，但是也无能为力。

我只能好好利用手上的资源，并且辅以我的三板斧，看下能开拓出什么局面。

当时我对自己说，如果一年内没有得到很好的价值体现，我就离职。

我不能忍心把青春白白浪费，每一分每一秒我都无比珍惜。

在刚毕业的时候，我就在负责部门运维系统的开发，现在我的工作产出甚至在我心里还没有刚毕业的时候高。

埋头做事，也要抬头看路啊。

这是个残酷的世界，我除了和公司的人竞争，我也在跟社会的人竞争，我也在跟从前的自己竞争。

我不能容忍自己做井底之蛙。

我对我的2020，非常不满意，甚至可以说是最灰暗的一年。

我想寻求解脱。

## 遗憾与展望

年末的时候，因为考勤系统切换，这个系统的数据也移交给了集团，完成了它的历史使命。

我的特点就是考虑问题周到，做事认真，所以面对这个以业务复杂性著称的系统，我完美的表现了自己在其中的价值。

在保证请假数据的准确性上，其实也不是一步到位，中途也发现了几次漏洞，但好在及时修补，快速迭代，不至于影响那么大。

基本遇到的问题设计到了日常开发中的大部分问题，比如：

- 前端的按钮没有做防护，导致重复发起了请求
- 多个请求并发执行，原本扣两次假被扣了一次
- 开发者的失误，导致意外的报错
- 业务上逻辑考虑的不完整

告别这个系统实际上是一个很好的释放，至少可以让脑子放松下，别再去理会那些人事方面的逻辑。

其实，从技术上来说，这个系统没有带给我很多突破。

但是从以一个主人翁的精神去做项目的态度上，这个项目给了我很多。